<html>
<head>
<title>Microsoft Content Viewer</title>
<LINK REL="stylesheet" TYPE="text/css" HREF="coolmint.css">
</head>
<body topmargin="0" leftmargin="0" >
<script language="JScript" src="../Personalization/FindLMSAPI.js"></script>

<script language="JScript">
	var strOldCols = "190px,*";
	document.onclick = evt_OnClick;
	document.onkeypress = evt_OnKeyPress;
	document.onreadystatechange = evt_OnReadyStateChange;

	var oLMSAPI	= null;
	function evt_OnReadyStateChange()
	{
		if (document.readyState != 'complete')
			return;

		oLMSAPI = FindLMSAPI();
		if(null != oLMSAPI)
		{
			oLMSAPI.LRNListenForEvents(EventHandler);
		}
	}


	
	function EventHandler(obj)
	{
	    switch(obj.type) //object is ready.
	    {
			case 0:
			case 1:
			case 2:
				document.all("__idNodeName").innerText = oLMSAPI.LRNGetScopedValue("lrn.item.title", obj.id);
				break;
			default:
			 return;
		}
	}
	window.onbeforeunload = onunload;
	
	function onunload()
	{
		if(null != oLMSAPI)
		{
			oLMSAPI.LRNUnListenForEvents(EventHandler);
		}
	}

	function evt_OnKeyPress()
	{
		switch (event.srcElement.id)
		{
			case "__idPrevious":
			case "__idNext":
			case "__idToggleTOC":
			case "__idToggleTOCText":
			case "__idToggleTOCImg":
			{
				if (event.keyCode == 13 || event.keyCode == 32)
				{
					evt_OnClick();
				}
				break;
			}
			default:
				return;
		}
							
		event.cancelBubble = true;
		event.returnValue = false;
	}

	function evt_OnClick()
	{
		
		switch (event.srcElement.id)
		{
			case "__idPrevious":
				if(null != oLMSAPI)
				{
					oLMSAPI.LRNDoPrevious();
				}
				break;
				
			case "__idNext":
				if(null != oLMSAPI)
				{
					oLMSAPI.LRNDoNext();
				}
				break;
				
			case "__idToggleTOC":
			case "__idToggleTOCText":
			case "__idToggleTOCImg":
			{
				if (document.all("__idToggleTOC").isopen)
				{
					document.all("__idToggleTOC").isopen = false;
					document.all("__idToggleTOCText").innerText = "Open Outline"
					strOldCols = parent.frames.__idParentUIFrameset.cols;
					parent.frames.__idParentUIFrameset.cols = "0,*";
				}
				else
				{
					document.all("__idToggleTOC").isopen = true;
					document.all("__idToggleTOCText").innerText = "Close Outline"
					parent.frames.__idParentUIFrameset.cols = strOldCols;
				}
				break;
			}
			default:
				return;
		}
							
		event.cancelBubble = true;
		event.returnValue = false;
	}

</script>
<table border="0"  class="NavArea" cellpadding="5" cellspacing="0" width="100%" height="100%">
	<tr>
		<td>
			<nobr>
				<span isopen=true id="__idToggleTOC" tabindex="1">
					<img    id="__idToggleTOCImg" style="cursor:hand;border:none"  src="opentoc.GIF" align=absmiddle>
					<span   id="__idToggleTOCText" class="NavLink"> Close Outline</span>
				</span>		
				<img id = "__idPrevious" style="cursor:hand;border:none" src="PREV_DWN.GIF" align=absmiddle tabindex="1">
				<img id = "__idNext" style="cursor:hand;border:none" src="NEXT_DWN.GIF"align=absmiddle tabindex="1">
				<span  style="font-size:12px;font-weight:bold" id='__idNodeName' ></span>
			<nobr>
							
		</td>
	</tr>
</table>
</body>
</html>
